(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42d91a64"],{"00b4":function(e,t,n){"use strict";n("ac1f");var i=n("23e7"),r=n("da84"),o=n("c65b"),a=n("e330"),s=n("1626"),d=n("861d"),l=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),c=r.Error,u=a(/./.test);i({target:"RegExp",proto:!0,forced:!l},{test:function(e){var t=this.exec;if(!s(t))return u(this,e);var n=o(t,this,e);if(null!==n&&!d(n))throw new c("RegExp exec method returned something other than an Object or null");return!!n}})},"0ccb":function(e,t,n){var i=n("e330"),r=n("50c4"),o=n("577e"),a=n("1148"),s=n("1d80"),d=i(a),l=i("".slice),c=Math.ceil,u=function(e){return function(t,n,i){var a,u,p=o(s(t)),h=r(n),v=p.length,f=void 0===i?" ":o(i);return h<=v||""==f?p:(a=h-v,u=d(f,c(a/f.length)),u.length>a&&(u=l(u,0,a)),e?p+u:u+p)}};e.exports={start:u(!1),end:u(!0)}},"107c":function(e,t,n){var i=n("d039"),r=n("da84"),o=r.RegExp;e.exports=i((function(){var e=o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},1148:function(e,t,n){"use strict";var i=n("da84"),r=n("5926"),o=n("577e"),a=n("1d80"),s=i.RangeError;e.exports=function(e){var t=o(a(this)),n="",i=r(e);if(i<0||i==1/0)throw s("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}},"25f0":function(e,t,n){"use strict";var i=n("e330"),r=n("5e77").PROPER,o=n("6eeb"),a=n("825a"),s=n("3a9b"),d=n("577e"),l=n("d039"),c=n("ad6d"),u="toString",p=RegExp.prototype,h=p[u],v=i(c),f=l((function(){return"/a/b"!=h.call({source:"a",flags:"b"})})),m=r&&h.name!=u;(f||m)&&o(RegExp.prototype,u,(function(){var e=a(this),t=d(e.source),n=e.flags,i=d(void 0===n&&s(p,e)&&!("flags"in p)?v(e):n);return"/"+t+"/"+i}),{unsafe:!0})},3835:function(e,t,n){"use strict";function i(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return d}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function r(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done);a=!0)if(o.push(i.value),t&&o.length===t)break}catch(d){s=!0,r=d}finally{try{a||null==n["return"]||n["return"]()}finally{if(s)throw r}}return o}}n("fb6a"),n("b0c0"),n("a630"),n("ac1f"),n("00b4");function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){if(e){if("string"===typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){return i(e)||r(e,t)||a(e,t)||s()}},"4d90":function(e,t,n){"use strict";var i=n("23e7"),r=n("0ccb").start,o=n("9a0c");i({target:"String",proto:!0,forced:o},{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},9263:function(e,t,n){"use strict";var i=n("c65b"),r=n("e330"),o=n("577e"),a=n("ad6d"),s=n("9f7f"),d=n("5692"),l=n("7c73"),c=n("69f3").get,u=n("fce3"),p=n("107c"),h=d("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,f=v,m=r("".charAt),y=r("".indexOf),g=r("".replace),b=r("".slice),x=function(){var e=/a/,t=/b*/g;return i(v,e,"a"),i(v,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),w=s.UNSUPPORTED_Y||s.BROKEN_CARET,_=void 0!==/()??/.exec("")[1],L=x||_||w||u||p;L&&(f=function(e){var t,n,r,s,d,u,p,L=this,E=c(L),S=o(e),P=E.raw;if(P)return P.lastIndex=L.lastIndex,t=i(f,P,S),L.lastIndex=P.lastIndex,t;var T=E.groups,C=w&&L.sticky,B=i(a,L),R=L.source,k=0,I=S;if(C&&(B=g(B,"y",""),-1===y(B,"g")&&(B+="g"),I=b(S,L.lastIndex),L.lastIndex>0&&(!L.multiline||L.multiline&&"\n"!==m(S,L.lastIndex-1))&&(R="(?: "+R+")",I=" "+I,k++),n=new RegExp("^(?:"+R+")",B)),_&&(n=new RegExp("^"+R+"$(?!\\s)",B)),x&&(r=L.lastIndex),s=i(v,C?n:L,I),C?s?(s.input=b(s.input,k),s[0]=b(s[0],k),s.index=L.lastIndex,L.lastIndex+=s[0].length):L.lastIndex=0:x&&s&&(L.lastIndex=L.global?s.index+s[0].length:r),_&&s&&s.length>1&&i(h,s[0],n,(function(){for(d=1;d<arguments.length-2;d++)void 0===arguments[d]&&(s[d]=void 0)})),s&&T)for(s.groups=u=l(null),d=0;d<T.length;d++)p=T[d],u[p[0]]=s[p[1]];return s}),e.exports=f},"9a0c":function(e,t,n){var i=n("342f");e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(i)},"9f7f":function(e,t,n){var i=n("d039"),r=n("da84"),o=r.RegExp;t.UNSUPPORTED_Y=i((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=i((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a630:function(e,t,n){var i=n("23e7"),r=n("4df4"),o=n("1c7e"),a=!o((function(e){Array.from(e)}));i({target:"Array",stat:!0,forced:a},{from:r})},ac1f:function(e,t,n){"use strict";var i=n("23e7"),r=n("9263");i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},ad6d:function(e,t,n){"use strict";var i=n("825a");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},ae95:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("diy-video-player",{attrs:{play_content:e.playBtnContent},on:{"update:play_content":function(t){e.playBtnContent=t}}})],1)},r=[],o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"player player_playing"},[n("video",{attrs:{id:"diy_video",width:e.videoWidth,height:e.videoHeight,playsinline:"","x5-playsinline":"",preload:e.preload}},[e._v("Sorry！Your browser doesn't support embedded videos.")]),n("div",{staticClass:"loading"},[n("a-spin",{attrs:{size:"large",spinning:e.loading_status}})],1),n("div",{staticClass:"controls"},[n("div",{staticClass:"bar"},[n("section",{directives:[{name:"show",rawName:"v-show",value:e.spriteShow,expression:"spriteShow"}],staticClass:"sprite_box",attrs:{"data-time":e.curTime}}),n("div",{staticClass:"bar_buffered"}),n("div",{staticClass:"bar_played"})]),n("div",{staticClass:"control_items"},[n("button",{staticClass:"play_btn",attrs:{"data-content":e.play_content}}),n("div",{staticClass:"time"},[e._v("0 / 0")]),n("section",{staticClass:"ctrl_right"},[n("button",{staticClass:"fullscreen"}),n("span",{staticClass:"extension_entry"},[e._v("...")]),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.extension_list_show,expression:"extension_list_show"}],staticClass:"extension_list"},[n("li",{},[e._v("下载")]),n("li",{},[e._v("截图")]),n("li",{},[e._v("画中画")])])])])])])},a=[],s=n("3835"),d=(n("caad"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("4d90"),n("25f0"),n("ac1f"),n("00b4"),{name:"DIY_Video_Player",props:{videoWidth:{type:null,default:"100%"},videoHeight:{type:null,default:"auto"},preload:{type:String,default:"meta"},play_content:{type:String,required:!0,validator:function(e){return-1!==["播放","暂停","Play","Pause"].indexOf(e)}},videoName:{type:String,default:"Rose.webm"},needPoster:{type:Boolean,default:!0}},data:function(){return{spriteShow:!1,curTime:"00:00:00",extension_list_show:!1,loading_status:!1,controlsTimer:null,player:null,video:null,bar:null,barLastX:0,barLeft:0,videoSeekTime:null,time:null,playedBar:null,sprite_x:0,imgNum:0,bufferedPercentage:0,isFullscreen:!1,normal_barLeft:0}},methods:{playBtnType:function(){return["播放","暂停"].includes(this.play_content)?"zh-CN":"en-US"},togglePause:function(e){this.$emit("update:play_content",e)},timeoutSet:function(e){var t=new AbortController;return this.signal=t.signal,new Promise((function(n,i){setTimeout((function(){n(new Response("timeout",{status:504,statusText:"timeout "})),t.abort()}),e)}))},getResource:function(){var e=this,t=[this.timeoutSet(12e3),this.getSprite()],n=Promise.race(t),i=this.getVideo();Promise.all([n,i]).then((function(t){if(console.log(t),!1===t[0].ok)return e.$message.error("请求超时，请刷新重试！"),e.player.classList.remove("player-loading"),void(e.loading_status=!1);switch(e.needPoster){case!0:e.video.poster="http://localhost:3000".concat(t[0].poster_path);break;default:}e.video.src=t[1],document.querySelector(".sprite_box").style.background="url(http://localhost:3000".concat(t[0].sprite_path,")"),e.imgNum=t[0].img_num}))},getSprite:function(){var e=this;return this.player.classList.add("player-loading"),this.loading_status=!0,fetch("http://localhost:3000/videos/sprite/".concat(this.videoName),{signal:this.signal}).then((function(e){return e.json()})).catch((function(t){e.player.classList.remove("player-loading"),e.loading_status=!1}))},getVideo:function(){var e=this,t=document.querySelector("#diy_video"),n=new MediaSource;return new Promise((function(i,r){n.addEventListener("sourceopen",(function(n){var i=n.target;URL.revokeObjectURL(t.src);var r='video/webm; codecs="opus, vp9"',o=i.addSourceBuffer(r);fetch("http://localhost:3000/videos/".concat(e.videoName),{}).then((function(e){return e.arrayBuffer()})).then((function(e){o.addEventListener("updateend",(function(){o.updating||"open"!==i.readyState||i.endOfStream()})),o.appendBuffer(e)}))})),i(URL.createObjectURL(n))}))},showControls:function(){clearTimeout(this.controlsTimer),this.player.classList.remove("player-controls-hide"),this.updatePlayedBarAndTime()},delayHideControls:function(){var e=this;this.showControls(),this.controlsTimer=setTimeout((function(){e.video.played.length&&!e.video.paused&&e.player.classList.add("player-controls-hide")}),3e3)},updatePlayedBarAndTime:function(e,t){e=void 0==e?Math.round(this.video.currentTime):e,t=null==t?Math.min(this.video.currentTime/this.video.duration,1):t,this.time.textContent=Math.round(e)+" / "+Math.round(this.video.duration),this.playedBar.style.width=t*(this.isFullscreen?.98*window.screen.width:this.barWidth)+"px"},onBarPointerStart:function(e){e.preventDefault(),this.bar.setPointerCapture(e.pointerId),this.bar.addEventListener("pointermove",this.onBarPointerMove,!0),this.video.pause(),this.barLastX=e.pageX;var t=this.calcPercentageAndSeekTime(),n=Object(s["a"])(t,2),i=n[0],r=n[1];this.updatePlayedBarAndTime(r,i)},onBarPointerMove:function(e){e.preventDefault(),this.barLastX=e.pageX,this.barPending||(this.barPending=!0,window.requestAnimationFrame(this.handleBarMove))},onBarPointerEnd:function(e){e.preventDefault(),this.bar.releasePointerCapture(e.pointerId),this.bar.removeEventListener("pointermove",this.onBarPointerMove,!0),this.videoSeekTime>0&&(this.video.currentTime=this.videoSeekTime),this.video.play()},calcPercentageAndSeekTime:function(){var e=0;switch(this.isFullscreen){case!0:e=Math.max(Math.min((this.barLastX-this.barLeft)/(.98*window.screen.width),1),0);break;default:e=Math.max(Math.min((this.barLastX-this.barLeft)/this.barWidth,1),0);break}return this.videoSeekTime=e*this.video.duration,console.log("played-per: "+e),[e,this.videoSeekTime]},handleBarMove:function(){if(this.barPending){var e=this.calcPercentageAndSeekTime(),t=Object(s["a"])(e,2),n=t[0],i=t[1];this.updatePlayedBarAndTime(i,n),this.barPending=!1}},thumbMover:function(e){var t,n,i,r,o=document.querySelector(".sprite_box");this.spriteShow=!0,i=e.target.getBoundingClientRect(),t=e.clientX-i.left,t=t<=0?0:t,t<=80?this.sprite_x=o.style.left="10px":t>=i.width-160?this.sprite_x=o.style.left=i.width-160-10+"px":this.sprite_x=o.style.left="".concat(t-80,"px"),n=t/i.width,this.curTime="00:00:"+Math.floor(n*this.video.duration).toString().padStart(2,"0"),r=Math.round(n*this.imgNum),o.style["background-position-y"]=-110*r+"px"},thumbImgChange:function(){var e,t=this,n=this.bar,i=document.querySelector(".sprite_box");i.addEventListener("mouseenter",(function(r){t.showControls(),console.log("in ....sprite_box >>>>"),clearTimeout(e),n.removeEventListener("mousemove",t.thumbMover,!1),i.style.left=t.sprite_x})),i.addEventListener("mouseleave",(function(e){t.spriteShow=!1,n.addEventListener("mousemove",t.thumbMover,!1)})),n.addEventListener("mousemove",this.thumbMover,!1),n.addEventListener("mouseleave",(function(n){t.sprite_x=0,e=setTimeout((function(){t.spriteShow=!1}),800)}))},checkIsStop:function(){var e=this,t=0,n=!1;this.loadingTimer=setInterval((function(){var i=e.video.currentTime;n||t!==i||e.video.paused?n&&i!==t&&(e.player.classList.remove("player-loading"),n=!1):(e.player.classList.add("player-loading"),n=!0),t=i}),100)}},mounted:function(){var e=this;this.player=document.querySelector(".player"),this.video=document.querySelector("video"),this.getResource(),this.player.addEventListener("click",this.delayHideControls),this.player.addEventListener("mousemove",this.delayHideControls),this.video.addEventListener("play",this.delayHideControls),this.video.addEventListener("pause",this.showControls),this.playedBar=document.querySelector(".bar_played"),this.bufferedBar=document.querySelector(".bar_buffered"),this.time=document.querySelector(".time"),this.video.addEventListener("durationchange",(function(){e.updatePlayedBarAndTime()})),this.video.addEventListener("timeupdate",(function(){e.player.classList.contains("player-controls-hide")||e.updatePlayedBarAndTime()})),this.video.addEventListener("progress",(function(){console.log("buffered.end(0): "+e.video.buffered.end(e.video.buffered.length-1)),e.bufferedPercentage=e.video.buffered.length?e.video.buffered.end(e.video.buffered.length-1)/e.video.duration:0,e.bufferedBar.style.width=e.bufferedPercentage*(e.isFullscreen?.98*window.screen.width:e.barWidth)+"px"}));var t=document.querySelector(".play_btn");t.addEventListener("click",(function(t){t.stopPropagation(),e.video.paused?e.video.play():e.video.pause()})),this.video.addEventListener("play",(function(){e.player.classList.add("player_playing"),e.togglePause("zh-CN"===e.playBtnType()?"暂停":"Pause")})),this.video.addEventListener("pause",(function(){e.player.classList.remove("player_playing"),e.togglePause("zh-CN"===e.playBtnType()?"播放":"Play")})),this.video.addEventListener("ended",(function(){e.player.classList.remove("player_playing"),e.togglePause("zh-CN"===e.playBtnType()?"播放":"Play"),e.video.currentTime=0})),this.bar=document.querySelector(".bar"),this.barWidth=this.bar.getBoundingClientRect().width,this.barLeft=this.bar.getBoundingClientRect().x,this.barPending=!1,this.barLastX=0,this.videoSeekTime=-1,this.bar.addEventListener("pointerdown",this.onBarPointerStart,!0),this.bar.addEventListener("pointerup",this.onBarPointerEnd,!0),this.bar.addEventListener("pointercancel",this.onBarPointerEnd,!0);var n=/(iPad|iPhone|iPod)/gi.test(navigator.platform),i=document.querySelector(".fullscreen");i.addEventListener("click",(function(t){t.stopPropagation(),document.fullscreenElement?(n?e.video.webkitExitFullscreen():document.exitFullscreen(),e.barLeft=e.normal_barLeft,e.bufferedBar.style.width=e.barWidth*e.bufferedPercentage+"px",e.isFullscreen=!1):(n?e.video.webkitEnterFullscreen():e.player.requestFullscreen(),e.normal_barLeft=e.barLeft,e.barLeft=.01*window.screen.width,console.log("全屏barLeft："+e.barLeft),e.bufferedBar.style.width=.98*window.screen.width*e.bufferedPercentage+"px",e.isFullscreen=!0)})),document.addEventListener("fullscreenchange",(function(){e.player.classList.toggle("player-fullscreen",document.fullscreenElement)})),this.video.addEventListener("canplay",(function(){e.thumbImgChange(),console.log("in video canplay..."),e.player.classList.remove("player-loading"),e.loading_status=!1})),this.video.addEventListener("waiting",(function(){console.log("in video waiting"),e.loading_status=!0,e.player.classList.add("player-loading");var t=e.video.currentTime,n=function n(){t!==e.video.currentTime&&(e.player.classList.remove("player-loading"),e.loading_status=!1,e.video.removeEventListener("timeupdate",n))};e.video.addEventListener("timeupdate",n)})),this.checkIsStop(),document.querySelector(".extension_entry").addEventListener("click",(function(){e.extension_list_show?e.extension_list_show=!1:e.extension_list_show=!0})),document.querySelector(".extension_list").addEventListener("click",(function(t){t=t||window.event;var n=t.target;switch(console.log(n.innerText),n.innerText){case"画中画":document.pictureInPictureEnabled&&(document.pictureInPictureElement?e.video.exitPictureInPicture():e.video.requestPictureInPicture(),e.video.addEventListener("enterpictureinpicture",(function(t){console.log(t),console.log(t.width,t.height),e.player.classList.add("player-pip")})),e.video.addEventListener("leavepictureinpicture",(function(){e.player.classList.remove("player-pip")}))),e.extension_list_show=!1;break;case"截图":console.log("in .... 截图");var i=document.createElement("canvas");i.width=e.video.videoWidth,i.height=e.video.videoHeight,i.getContext("2d").drawImage(e.video,0,0,i.width,i.height);var r=e.video.currentTime+".png";i.toBlob((function(e){var t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=r,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}),"image/png"),e.extension_list_show=!1;break;case"下载":var o=document.createElement("a"),a=new XMLHttpRequest;a.open("GET","http://localhost:3000/videos/".concat(e.videoName),!0),a.responseType="blob",a.onload=function(e){var t=window.URL.createObjectURL(a.response);o.href=t,o.download="Rose.webm",document.body.appendChild(o),o.click(),document.body.removeChild(o)},a.send(),e.extension_list_show=!1;break;default:break}}))},destroyed:function(){clearInterval(this.loadingTimer)}}),l=d,c=(n("fe3e"),n("2877")),u=Object(c["a"])(l,o,a,!1,null,"4196b0d6",null),p=u.exports,h={name:"DiyVideoPlayer_Index",components:{diyVideoPlayer:p},data:function(){return{playBtnContent:"Play"}},methods:{},created:function(){}},v=h,f=Object(c["a"])(v,i,r,!1,null,null,null);t["default"]=f.exports},b8a8:function(e,t,n){},caad:function(e,t,n){"use strict";var i=n("23e7"),r=n("4d64").includes,o=n("44d2");i({target:"Array",proto:!0},{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},d28b:function(e,t,n){var i=n("746f");i("iterator")},e01a:function(e,t,n){"use strict";var i=n("23e7"),r=n("83ab"),o=n("da84"),a=n("e330"),s=n("1a2d"),d=n("1626"),l=n("3a9b"),c=n("577e"),u=n("9bf2").f,p=n("e893"),h=o.Symbol,v=h&&h.prototype;if(r&&d(h)&&(!("description"in v)||void 0!==h().description)){var f={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:c(arguments[0]),t=l(v,this)?new h(e):void 0===e?h():h(e);return""===e&&(f[t]=!0),t};p(m,h),m.prototype=v,v.constructor=m;var y="Symbol(test)"==String(h("test")),g=a(v.toString),b=a(v.valueOf),x=/^Symbol\((.*)\)[^)]+$/,w=a("".replace),_=a("".slice);u(v,"description",{configurable:!0,get:function(){var e=b(this),t=g(e);if(s(f,e))return"";var n=y?_(t,7,-1):w(t,x,"$1");return""===n?void 0:n}}),i({global:!0,forced:!0},{Symbol:m})}},fb6a:function(e,t,n){"use strict";var i=n("23e7"),r=n("da84"),o=n("e8b5"),a=n("68ee"),s=n("861d"),d=n("23cb"),l=n("07fa"),c=n("fc6a"),u=n("8418"),p=n("b622"),h=n("1dde"),v=n("f36a"),f=h("slice"),m=p("species"),y=r.Array,g=Math.max;i({target:"Array",proto:!0,forced:!f},{slice:function(e,t){var n,i,r,p=c(this),h=l(p),f=d(e,h),b=d(void 0===t?h:t,h);if(o(p)&&(n=p.constructor,a(n)&&(n===y||o(n.prototype))?n=void 0:s(n)&&(n=n[m],null===n&&(n=void 0)),n===y||void 0===n))return v(p,f,b);for(i=new(void 0===n?y:n)(g(b-f,0)),r=0;f<b;f++,r++)f in p&&u(i,r,p[f]);return i.length=r,i}})},fce3:function(e,t,n){var i=n("d039"),r=n("da84"),o=r.RegExp;e.exports=i((function(){var e=o(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},fe3e:function(e,t,n){"use strict";n("b8a8")}}]);